<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.45" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://coderwdd.github.io/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html"><meta property="og:site_name" content="瓜娃子"><meta property="og:title" content="Compose中的阶段"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-06-05T15:01:26.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="Jetpack Compose"><meta property="article:tag" content="Android"><meta property="article:tag" content="Kotlin"><meta property="article:modified_time" content="2022-06-05T15:01:26.000Z"><title>Compose中的阶段 | 瓜娃子</title><meta name="description" content="A blog for daily learning!">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.927c3f8e.css">
    <link rel="modulepreload" href="/assets/app.776ac834.js"><link rel="modulepreload" href="/assets/Compose中的阶段.html.aa610ee3.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/Compose中的阶段.html.071dd4b8.js"><link rel="prefetch" href="/assets/index.html.8250e4ce.js"><link rel="prefetch" href="/assets/intro.html.f9a64757.js"><link rel="prefetch" href="/assets/Leetcode-1175.html.4313a808.js"><link rel="prefetch" href="/assets/Leetcode-1200.html.fb1042d6.js"><link rel="prefetch" href="/assets/Leetcode-1217.html.c7c4adff.js"><link rel="prefetch" href="/assets/Leetcode-241.html.4760b987.js"><link rel="prefetch" href="/assets/Leetcode-515.html.0fe63922.js"><link rel="prefetch" href="/assets/Leetcode-648.html.061333d3.js"><link rel="prefetch" href="/assets/Leetcode-710.html.f36a1a47.js"><link rel="prefetch" href="/assets/Leetcode-729.html.5b99c12e.js"><link rel="prefetch" href="/assets/Leetcode-871.html.f9b8ea65.js"><link rel="prefetch" href="/assets/Leetcode-873.html.65a661bc.js"><link rel="prefetch" href="/assets/index.html.abe850cd.js"><link rel="prefetch" href="/assets/剑指Offer-Ⅱ 091.html.abfa7b16.js"><link rel="prefetch" href="/assets/index.html.8352cfe2.js"><link rel="prefetch" href="/assets/Git.html.8903376e.js"><link rel="prefetch" href="/assets/index.html.aca64420.js"><link rel="prefetch" href="/assets/京东脚本.html.1c040c69.js"><link rel="prefetch" href="/assets/小米9root.html.b361392c.js"><link rel="prefetch" href="/assets/小米Ac2100.html.d70aafbc.js"><link rel="prefetch" href="/assets/index.html.c63745a7.js"><link rel="prefetch" href="/assets/Android基础之LiveData.html.d5522557.js"><link rel="prefetch" href="/assets/Android基础之RecyclerView.html.f33e1685.js"><link rel="prefetch" href="/assets/Android基础之ViewModel.html.d43198c6.js"><link rel="prefetch" href="/assets/Android框架之数据库.html.a1c4fcb3.js"><link rel="prefetch" href="/assets/Android自定义View.html.bf280c63.js"><link rel="prefetch" href="/assets/Flutter安装教程.html.ce865adc.js"><link rel="prefetch" href="/assets/index.html.6564f076.js"><link rel="prefetch" href="/assets/四大组件之Activity.html.8567b7cc.js"><link rel="prefetch" href="/assets/四大组件之BroadcastReceiver.html.44e1a731.js"><link rel="prefetch" href="/assets/四大组件之ContentProvider.html.92b40543.js"><link rel="prefetch" href="/assets/四大组件之Service.html.2722ffc5.js"><link rel="prefetch" href="/assets/AndroidStylingSystem.html.f9600af5.js"><link rel="prefetch" href="/assets/Compose中的BottomNavigation使用.html.8e10e9fd.js"><link rel="prefetch" href="/assets/Compose中的附带效应.html.c260e464.js"><link rel="prefetch" href="/assets/Compose动画.html.63f0e5df.js"><link rel="prefetch" href="/assets/Compose手势.html.172f8f2e.js"><link rel="prefetch" href="/assets/Compose架构分层.html.535be2e5.js"><link rel="prefetch" href="/assets/Compose状态管理.html.e09de2d4.js"><link rel="prefetch" href="/assets/Compose生命周期.html.8c35d2fe.js"><link rel="prefetch" href="/assets/Compose系列之入门简介.html.c4962bce.js"><link rel="prefetch" href="/assets/Compose编程思想.html.ab794935.js"><link rel="prefetch" href="/assets/Compose自定义View.html.05a71603.js"><link rel="prefetch" href="/assets/index.html.2dce1540.js"><link rel="prefetch" href="/assets/Kotlin RoadMap.html.d6579379.js"><link rel="prefetch" href="/assets/Kotlin与Java互操作.html.7d9a9fa4.js"><link rel="prefetch" href="/assets/Kotlin协程.html.28df113b.js"><link rel="prefetch" href="/assets/Kotlin常用语法.html.56c8cdfc.js"><link rel="prefetch" href="/assets/Null Safety.html.9000e5a1.js"><link rel="prefetch" href="/assets/index.html.f23d0db5.js"><link rel="prefetch" href="/assets/函数式编程.html.aa9ead9d.js"><link rel="prefetch" href="/assets/基础语法.html.fd9638cc.js"><link rel="prefetch" href="/assets/常见问题总结.html.5383cfcf.js"><link rel="prefetch" href="/assets/标准函数.html.47bda8cf.js"><link rel="prefetch" href="/assets/面向对象.html.bdb59a71.js"><link rel="prefetch" href="/assets/CSS属性及引入方式.html.d307b2d6.js"><link rel="prefetch" href="/assets/CSS特性.html.f4987815.js"><link rel="prefetch" href="/assets/CSS盒子.html.0dda09ef.js"><link rel="prefetch" href="/assets/CSS语法格式及选择器.html.297ac8cc.js"><link rel="prefetch" href="/assets/index.html.8c1090db.js"><link rel="prefetch" href="/assets/精灵图.html.7632c16a.js"><link rel="prefetch" href="/assets/index.html.6d4f87b8.js"><link rel="prefetch" href="/assets/基本语法概述.html.15edfa48.js"><link rel="prefetch" href="/assets/Html中的JavaScript.html.bb034c30.js"><link rel="prefetch" href="/assets/index.html.aad7f9eb.js"><link rel="prefetch" href="/assets/语言基础.html.db792d49.js"><link rel="prefetch" href="/assets/Flex布局.html.14fe8453.js"><link rel="prefetch" href="/assets/index.html.aa12c9b5.js"><link rel="prefetch" href="/assets/index.html.2703c5ff.js"><link rel="prefetch" href="/assets/Vue-cli.html.ea9a5e05.js"><link rel="prefetch" href="/assets/Vue基础.html.85abd1d3.js"><link rel="prefetch" href="/assets/Vue封装的过渡与动画.html.ac711013.js"><link rel="prefetch" href="/assets/Vue生命周期和组件.html.3816354a.js"><link rel="prefetch" href="/assets/浏览器本地存储.html.f6d23b39.js"><link rel="prefetch" href="/assets/组件间通信.html.3b41d449.js"><link rel="prefetch" href="/assets/index.html.93f4c42d.js"><link rel="prefetch" href="/assets/分治算法.html.1e2e815c.js"><link rel="prefetch" href="/assets/单源最短路.html.f802540f.js"><link rel="prefetch" href="/assets/图的基本概念.html.b4ccf8b1.js"><link rel="prefetch" href="/assets/最小生成树.html.c8d6d96a.js"><link rel="prefetch" href="/assets/高级数据结构.html.a678e1c0.js"><link rel="prefetch" href="/assets/index.html.db7cd4e6.js"><link rel="prefetch" href="/assets/考试重点.html.e410dcc5.js"><link rel="prefetch" href="/assets/面向对象程序设计基础.html.de7910d9.js"><link rel="prefetch" href="/assets/index.html.02f12358.js"><link rel="prefetch" href="/assets/SQL.html.16a48031.js"><link rel="prefetch" href="/assets/关系数据理论.html.54309536.js"><link rel="prefetch" href="/assets/复习题！.html.00632c06.js"><link rel="prefetch" href="/assets/并发控制.html.3bb81071.js"><link rel="prefetch" href="/assets/数据库事务于故障恢复.html.ee9cd0eb.js"><link rel="prefetch" href="/assets/数据库安全.html.6ef231dc.js"><link rel="prefetch" href="/assets/数据库完整性.html.7fe5dc0d.js"><link rel="prefetch" href="/assets/数据库设计.html.f6d0b966.js"><link rel="prefetch" href="/assets/第一章：基础篇.html.329c8ac6.js"><link rel="prefetch" href="/assets/Java考试复习.html.c4be55ac.js"><link rel="prefetch" href="/assets/index.html.6e34799b.js"><link rel="prefetch" href="/assets/Matlab入门一.html.b24d7645.js"><link rel="prefetch" href="/assets/index.html.286a9bab.js"><link rel="prefetch" href="/assets/index.html.daf48dfc.js"><link rel="prefetch" href="/assets/分治算法.html.8153e455.js"><link rel="prefetch" href="/assets/动态规划.html.b85349f8.js"><link rel="prefetch" href="/assets/贪心法.html.1e2eca79.js"><link rel="prefetch" href="/assets/index.html.08a8ca75.js"><link rel="prefetch" href="/assets/Annotion.html.ba7d1e8a.js"><link rel="prefetch" href="/assets/Java中判断对象相等.html.2728f171.js"><link rel="prefetch" href="/assets/Java反射.html.78fd6d89.js"><link rel="prefetch" href="/assets/Java序列化.html.1742b9a6.js"><link rel="prefetch" href="/assets/index.html.b8f6ee2f.js"><link rel="prefetch" href="/assets/String、StringBuffer、StringBuilder.html.7b303d62.js"><link rel="prefetch" href="/assets/抽象类与接口.html.a8f02eb4.js"><link rel="prefetch" href="/assets/深拷贝与浅拷贝.html.a0f5928f.js"><link rel="prefetch" href="/assets/index.html.09553ecd.js"><link rel="prefetch" href="/assets/404.html.5dd37f2a.js"><link rel="prefetch" href="/assets/index.html.c8fecfc0.js"><link rel="prefetch" href="/assets/index.html.e57ca7de.js"><link rel="prefetch" href="/assets/index.html.274317c2.js"><link rel="prefetch" href="/assets/index.html.21067c46.js"><link rel="prefetch" href="/assets/index.html.61cd1e8b.js"><link rel="prefetch" href="/assets/index.html.81c1412a.js"><link rel="prefetch" href="/assets/index.html.82266866.js"><link rel="prefetch" href="/assets/index.html.9bd57706.js"><link rel="prefetch" href="/assets/index.html.3fc291db.js"><link rel="prefetch" href="/assets/index.html.459990d9.js"><link rel="prefetch" href="/assets/index.html.0d535fd1.js"><link rel="prefetch" href="/assets/index.html.0881fd37.js"><link rel="prefetch" href="/assets/index.html.39ea259b.js"><link rel="prefetch" href="/assets/index.html.13d51046.js"><link rel="prefetch" href="/assets/index.html.d5767760.js"><link rel="prefetch" href="/assets/index.html.50b5d9e6.js"><link rel="prefetch" href="/assets/index.html.625d1b1b.js"><link rel="prefetch" href="/assets/index.html.654afb33.js"><link rel="prefetch" href="/assets/index.html.0705f233.js"><link rel="prefetch" href="/assets/index.html.968ec86f.js"><link rel="prefetch" href="/assets/index.html.abe2a084.js"><link rel="prefetch" href="/assets/index.html.f6fc6c67.js"><link rel="prefetch" href="/assets/index.html.0f108e96.js"><link rel="prefetch" href="/assets/index.html.1963146f.js"><link rel="prefetch" href="/assets/index.html.1d2cb2b3.js"><link rel="prefetch" href="/assets/index.html.ae4f4ae2.js"><link rel="prefetch" href="/assets/index.html.09e3e571.js"><link rel="prefetch" href="/assets/index.html.bc7ece18.js"><link rel="prefetch" href="/assets/index.html.3d6c032d.js"><link rel="prefetch" href="/assets/index.html.915f19a6.js"><link rel="prefetch" href="/assets/index.html.707f334a.js"><link rel="prefetch" href="/assets/index.html.ec68c3a4.js"><link rel="prefetch" href="/assets/index.html.78303649.js"><link rel="prefetch" href="/assets/index.html.9603c7a8.js"><link rel="prefetch" href="/assets/index.html.f3f9844c.js"><link rel="prefetch" href="/assets/index.html.8b5d2de5.js"><link rel="prefetch" href="/assets/index.html.0fad2f13.js"><link rel="prefetch" href="/assets/index.html.ab10a91e.js"><link rel="prefetch" href="/assets/index.html.7f059d47.js"><link rel="prefetch" href="/assets/index.html.eac5edb1.js"><link rel="prefetch" href="/assets/index.html.6fb4c307.js"><link rel="prefetch" href="/assets/index.html.ce58161a.js"><link rel="prefetch" href="/assets/index.html.ee890e9c.js"><link rel="prefetch" href="/assets/index.html.cec1f1f3.js"><link rel="prefetch" href="/assets/index.html.ebf48e3d.js"><link rel="prefetch" href="/assets/index.html.b23c87fb.js"><link rel="prefetch" href="/assets/index.html.e432533b.js"><link rel="prefetch" href="/assets/index.html.01e33d05.js"><link rel="prefetch" href="/assets/index.html.cbf5c4fd.js"><link rel="prefetch" href="/assets/index.html.529fb34a.js"><link rel="prefetch" href="/assets/index.html.1eb5b785.js"><link rel="prefetch" href="/assets/index.html.aeeb2688.js"><link rel="prefetch" href="/assets/index.html.1c76d3a2.js"><link rel="prefetch" href="/assets/index.html.580f3434.js"><link rel="prefetch" href="/assets/index.html.cb1181f3.js"><link rel="prefetch" href="/assets/index.html.e9e76b1a.js"><link rel="prefetch" href="/assets/index.html.87e3923f.js"><link rel="prefetch" href="/assets/index.html.2b7caec0.js"><link rel="prefetch" href="/assets/index.html.10bf3c60.js"><link rel="prefetch" href="/assets/index.html.ec26a39d.js"><link rel="prefetch" href="/assets/index.html.736730e8.js"><link rel="prefetch" href="/assets/index.html.debf74cd.js"><link rel="prefetch" href="/assets/index.html.0319d1c3.js"><link rel="prefetch" href="/assets/intro.html.89ac5ed6.js"><link rel="prefetch" href="/assets/Leetcode-1175.html.aceb8f9a.js"><link rel="prefetch" href="/assets/Leetcode-1200.html.9abc211d.js"><link rel="prefetch" href="/assets/Leetcode-1217.html.d836bcdc.js"><link rel="prefetch" href="/assets/Leetcode-241.html.d2546319.js"><link rel="prefetch" href="/assets/Leetcode-515.html.35621230.js"><link rel="prefetch" href="/assets/Leetcode-648.html.ef5f00dd.js"><link rel="prefetch" href="/assets/Leetcode-710.html.38877cb1.js"><link rel="prefetch" href="/assets/Leetcode-729.html.4f2906b4.js"><link rel="prefetch" href="/assets/Leetcode-871.html.75b168fa.js"><link rel="prefetch" href="/assets/Leetcode-873.html.c27777c2.js"><link rel="prefetch" href="/assets/index.html.2182bbe6.js"><link rel="prefetch" href="/assets/剑指Offer-Ⅱ 091.html.ed28a3d3.js"><link rel="prefetch" href="/assets/index.html.6e909b51.js"><link rel="prefetch" href="/assets/Git.html.da4d9ec4.js"><link rel="prefetch" href="/assets/index.html.05c636be.js"><link rel="prefetch" href="/assets/京东脚本.html.445eb651.js"><link rel="prefetch" href="/assets/小米9root.html.f4586f76.js"><link rel="prefetch" href="/assets/小米Ac2100.html.257f64f7.js"><link rel="prefetch" href="/assets/index.html.c68e1bda.js"><link rel="prefetch" href="/assets/Android基础之LiveData.html.ef3eb51f.js"><link rel="prefetch" href="/assets/Android基础之RecyclerView.html.c90088d7.js"><link rel="prefetch" href="/assets/Android基础之ViewModel.html.27bc4fe1.js"><link rel="prefetch" href="/assets/Android框架之数据库.html.be6ea55b.js"><link rel="prefetch" href="/assets/Android自定义View.html.4f08e795.js"><link rel="prefetch" href="/assets/Flutter安装教程.html.414d255b.js"><link rel="prefetch" href="/assets/index.html.abf01268.js"><link rel="prefetch" href="/assets/四大组件之Activity.html.afe16eae.js"><link rel="prefetch" href="/assets/四大组件之BroadcastReceiver.html.4ffaafc0.js"><link rel="prefetch" href="/assets/四大组件之ContentProvider.html.3c41c1c1.js"><link rel="prefetch" href="/assets/四大组件之Service.html.e0d1e070.js"><link rel="prefetch" href="/assets/AndroidStylingSystem.html.0861cc61.js"><link rel="prefetch" href="/assets/Compose中的BottomNavigation使用.html.c8402e1a.js"><link rel="prefetch" href="/assets/Compose中的附带效应.html.90fae326.js"><link rel="prefetch" href="/assets/Compose动画.html.7959f1af.js"><link rel="prefetch" href="/assets/Compose手势.html.24703a46.js"><link rel="prefetch" href="/assets/Compose架构分层.html.e9bab0f5.js"><link rel="prefetch" href="/assets/Compose状态管理.html.d1e97fe3.js"><link rel="prefetch" href="/assets/Compose生命周期.html.29c36ffb.js"><link rel="prefetch" href="/assets/Compose系列之入门简介.html.ca38b757.js"><link rel="prefetch" href="/assets/Compose编程思想.html.d3b5cc05.js"><link rel="prefetch" href="/assets/Compose自定义View.html.f98341c6.js"><link rel="prefetch" href="/assets/index.html.2931b76a.js"><link rel="prefetch" href="/assets/Kotlin RoadMap.html.2200c4b2.js"><link rel="prefetch" href="/assets/Kotlin与Java互操作.html.8e3e2d5e.js"><link rel="prefetch" href="/assets/Kotlin协程.html.76a127d2.js"><link rel="prefetch" href="/assets/Kotlin常用语法.html.b287aeb5.js"><link rel="prefetch" href="/assets/Null Safety.html.5834eead.js"><link rel="prefetch" href="/assets/index.html.abb37b1d.js"><link rel="prefetch" href="/assets/函数式编程.html.38b7952d.js"><link rel="prefetch" href="/assets/基础语法.html.5ff4702d.js"><link rel="prefetch" href="/assets/常见问题总结.html.f854a0ff.js"><link rel="prefetch" href="/assets/标准函数.html.7b0dedc7.js"><link rel="prefetch" href="/assets/面向对象.html.7a22544a.js"><link rel="prefetch" href="/assets/CSS属性及引入方式.html.c4915110.js"><link rel="prefetch" href="/assets/CSS特性.html.a5e796a9.js"><link rel="prefetch" href="/assets/CSS盒子.html.8ab71407.js"><link rel="prefetch" href="/assets/CSS语法格式及选择器.html.5c4fd082.js"><link rel="prefetch" href="/assets/index.html.65184443.js"><link rel="prefetch" href="/assets/精灵图.html.a2abdf8c.js"><link rel="prefetch" href="/assets/index.html.e545ef0c.js"><link rel="prefetch" href="/assets/基本语法概述.html.f90305b6.js"><link rel="prefetch" href="/assets/Html中的JavaScript.html.e93783c9.js"><link rel="prefetch" href="/assets/index.html.3aa17054.js"><link rel="prefetch" href="/assets/语言基础.html.65785eb7.js"><link rel="prefetch" href="/assets/Flex布局.html.158731b3.js"><link rel="prefetch" href="/assets/index.html.a74ad447.js"><link rel="prefetch" href="/assets/index.html.89f608a9.js"><link rel="prefetch" href="/assets/Vue-cli.html.ddb5d6b1.js"><link rel="prefetch" href="/assets/Vue基础.html.e0a07068.js"><link rel="prefetch" href="/assets/Vue封装的过渡与动画.html.92fd33aa.js"><link rel="prefetch" href="/assets/Vue生命周期和组件.html.8b7a5ce3.js"><link rel="prefetch" href="/assets/浏览器本地存储.html.e23a3fee.js"><link rel="prefetch" href="/assets/组件间通信.html.271c95ed.js"><link rel="prefetch" href="/assets/index.html.93aef534.js"><link rel="prefetch" href="/assets/分治算法.html.8260fa1c.js"><link rel="prefetch" href="/assets/单源最短路.html.e47490c3.js"><link rel="prefetch" href="/assets/图的基本概念.html.486cc7db.js"><link rel="prefetch" href="/assets/最小生成树.html.0f5bec3a.js"><link rel="prefetch" href="/assets/高级数据结构.html.749a73d2.js"><link rel="prefetch" href="/assets/index.html.85e5c21c.js"><link rel="prefetch" href="/assets/考试重点.html.ed11c987.js"><link rel="prefetch" href="/assets/面向对象程序设计基础.html.4d56e088.js"><link rel="prefetch" href="/assets/index.html.bc8e9834.js"><link rel="prefetch" href="/assets/SQL.html.ceb222a5.js"><link rel="prefetch" href="/assets/关系数据理论.html.99778a4c.js"><link rel="prefetch" href="/assets/复习题！.html.d4b3cb01.js"><link rel="prefetch" href="/assets/并发控制.html.68d1cbc8.js"><link rel="prefetch" href="/assets/数据库事务于故障恢复.html.b040abf8.js"><link rel="prefetch" href="/assets/数据库安全.html.fe5ac614.js"><link rel="prefetch" href="/assets/数据库完整性.html.63c99d9d.js"><link rel="prefetch" href="/assets/数据库设计.html.8e7491ce.js"><link rel="prefetch" href="/assets/第一章：基础篇.html.dfeb542a.js"><link rel="prefetch" href="/assets/Java考试复习.html.1a4c5c24.js"><link rel="prefetch" href="/assets/index.html.8949fa1a.js"><link rel="prefetch" href="/assets/Matlab入门一.html.b2c69364.js"><link rel="prefetch" href="/assets/index.html.fa22693c.js"><link rel="prefetch" href="/assets/index.html.7af22fc7.js"><link rel="prefetch" href="/assets/分治算法.html.c9d0aa3e.js"><link rel="prefetch" href="/assets/动态规划.html.fe1fc025.js"><link rel="prefetch" href="/assets/贪心法.html.c4cc4abf.js"><link rel="prefetch" href="/assets/index.html.9b979ef8.js"><link rel="prefetch" href="/assets/Annotion.html.3da9eaf1.js"><link rel="prefetch" href="/assets/Java中判断对象相等.html.21307c67.js"><link rel="prefetch" href="/assets/Java反射.html.2ce7ed29.js"><link rel="prefetch" href="/assets/Java序列化.html.329394f8.js"><link rel="prefetch" href="/assets/index.html.b3aa00d7.js"><link rel="prefetch" href="/assets/String、StringBuffer、StringBuilder.html.f14081ee.js"><link rel="prefetch" href="/assets/抽象类与接口.html.8b5e742d.js"><link rel="prefetch" href="/assets/深拷贝与浅拷贝.html.f2075400.js"><link rel="prefetch" href="/assets/index.html.2a735a6a.js"><link rel="prefetch" href="/assets/404.html.0c8252b8.js"><link rel="prefetch" href="/assets/index.html.d5cc08ad.js"><link rel="prefetch" href="/assets/index.html.1331f6ca.js"><link rel="prefetch" href="/assets/index.html.da6c3a69.js"><link rel="prefetch" href="/assets/index.html.1174fbbd.js"><link rel="prefetch" href="/assets/index.html.c73d2264.js"><link rel="prefetch" href="/assets/index.html.1e315145.js"><link rel="prefetch" href="/assets/index.html.514b72a3.js"><link rel="prefetch" href="/assets/index.html.7d0f19a4.js"><link rel="prefetch" href="/assets/index.html.18f4a9c0.js"><link rel="prefetch" href="/assets/index.html.695da75a.js"><link rel="prefetch" href="/assets/index.html.f13105f7.js"><link rel="prefetch" href="/assets/index.html.d16e40af.js"><link rel="prefetch" href="/assets/index.html.ad114cb9.js"><link rel="prefetch" href="/assets/index.html.26f21656.js"><link rel="prefetch" href="/assets/index.html.f566ec00.js"><link rel="prefetch" href="/assets/index.html.d831ab1d.js"><link rel="prefetch" href="/assets/index.html.86e4e58c.js"><link rel="prefetch" href="/assets/index.html.68a2fff3.js"><link rel="prefetch" href="/assets/index.html.f908e168.js"><link rel="prefetch" href="/assets/index.html.156f2ac5.js"><link rel="prefetch" href="/assets/index.html.7d459bd0.js"><link rel="prefetch" href="/assets/index.html.0dcb92ee.js"><link rel="prefetch" href="/assets/index.html.f98d8b5d.js"><link rel="prefetch" href="/assets/index.html.7172ab74.js"><link rel="prefetch" href="/assets/index.html.a1564860.js"><link rel="prefetch" href="/assets/index.html.af330ec0.js"><link rel="prefetch" href="/assets/index.html.eee0207e.js"><link rel="prefetch" href="/assets/index.html.181c3216.js"><link rel="prefetch" href="/assets/index.html.653f957a.js"><link rel="prefetch" href="/assets/index.html.f572160a.js"><link rel="prefetch" href="/assets/index.html.a8b97692.js"><link rel="prefetch" href="/assets/index.html.497848a4.js"><link rel="prefetch" href="/assets/index.html.76ff61ae.js"><link rel="prefetch" href="/assets/index.html.1b21914d.js"><link rel="prefetch" href="/assets/index.html.6cd79969.js"><link rel="prefetch" href="/assets/index.html.d986a357.js"><link rel="prefetch" href="/assets/index.html.4cc525de.js"><link rel="prefetch" href="/assets/index.html.e0c487a6.js"><link rel="prefetch" href="/assets/index.html.c2031158.js"><link rel="prefetch" href="/assets/index.html.98a6da02.js"><link rel="prefetch" href="/assets/index.html.b9cb0b96.js"><link rel="prefetch" href="/assets/index.html.0f12e616.js"><link rel="prefetch" href="/assets/index.html.285e3e31.js"><link rel="prefetch" href="/assets/index.html.6ed5232c.js"><link rel="prefetch" href="/assets/index.html.b2415e8a.js"><link rel="prefetch" href="/assets/index.html.8ac45e3b.js"><link rel="prefetch" href="/assets/index.html.92ca2e51.js"><link rel="prefetch" href="/assets/index.html.440056c5.js"><link rel="prefetch" href="/assets/index.html.f2672d1c.js"><link rel="prefetch" href="/assets/index.html.c3cb2dba.js"><link rel="prefetch" href="/assets/index.html.c7de61c3.js"><link rel="prefetch" href="/assets/index.html.958242b2.js"><link rel="prefetch" href="/assets/index.html.83b1f080.js"><link rel="prefetch" href="/assets/index.html.55a7f22f.js"><link rel="prefetch" href="/assets/index.html.82d7c4cf.js"><link rel="prefetch" href="/assets/index.html.665401a9.js"><link rel="prefetch" href="/assets/index.html.d5e35054.js"><link rel="prefetch" href="/assets/index.html.3b1d398b.js"><link rel="prefetch" href="/assets/index.html.512dc3aa.js"><link rel="prefetch" href="/assets/index.html.b19f5086.js"><link rel="prefetch" href="/assets/index.html.b70b0e81.js"><link rel="prefetch" href="/assets/index.html.a955d9f2.js"><link rel="prefetch" href="/assets/404.389153b4.js"><link rel="prefetch" href="/assets/Layout.fbc3a1a2.js"><link rel="prefetch" href="/assets/Slide.186b82f0.js"><link rel="prefetch" href="/assets/Blog.0805c5af.js"><link rel="prefetch" href="/assets/giscus.es.75d9a49d.js"><link rel="prefetch" href="/assets/auto.esm.edfc11f4.js"><link rel="prefetch" href="/assets/index.db7a31cb.js"><link rel="prefetch" href="/assets/index.e1c5a3de.js"><link rel="prefetch" href="/assets/mermaid.esm.min.35088203.js"><link rel="prefetch" href="/assets/highlight.esm.9b852bc5.js"><link rel="prefetch" href="/assets/markdown.esm.77e8db25.js"><link rel="prefetch" href="/assets/math.esm.cb9d4be3.js"><link rel="prefetch" href="/assets/notes.esm.62c5f19d.js"><link rel="prefetch" href="/assets/reveal.esm.41ec5d7f.js"><link rel="prefetch" href="/assets/search.esm.04894411.js"><link rel="prefetch" href="/assets/zoom.esm.78977eba.js"><link rel="prefetch" href="/assets/photoswipe.esm.2debdee5.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/" class="home-link"><img class="logo" src="/logo.svg" alt="瓜娃子"><!----><span class="site-name hide-in-pad">瓜娃子</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="首页"><span class="icon iconfont icon-home" style=""></span>首页<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Android"><span class="title"><span class="icon iconfont icon-logo" style=""></span>Android</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/Android/Kotlin/" class="nav-link" aria-label="Kotlin"><!---->Kotlin<!----></a></li><li class="dropdown-item"><a href="/Android/Basics/" class="nav-link" aria-label="Android Basics"><!---->Android Basics<!----></a></li><li class="dropdown-item"><a href="/Android/Intermediate/" class="nav-link active" aria-label="Android Intermediate"><!---->Android Intermediate<!----></a></li><li class="dropdown-item"><a href="/Android/Advanced/" class="nav-link" aria-label="Android Advanced"><!---->Android Advanced<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Java"><span class="title"><!---->Java</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/Java/Basics/" class="nav-link" aria-label="Java Basics"><!---->Java Basics<!----></a></li><li class="dropdown-item"><a href="/Java/GUI/" class="nav-link" aria-label="Java GUI"><!---->Java GUI<!----></a></li><li class="dropdown-item"><a href="/Java/Advanced/" class="nav-link" aria-label="Java Advanced"><!---->Java Advanced<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Frontend"><span class="title"><!---->Frontend</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/Frontend/HTML/" class="nav-link" aria-label="HTML"><!---->HTML<!----></a></li><li class="dropdown-item"><a href="/Frontend/CSS/" class="nav-link" aria-label="CSS"><!---->CSS<!----></a></li><li class="dropdown-item"><a href="/Frontend/JavaScript/" class="nav-link" aria-label="JavaScript"><!---->JavaScript<!----></a></li><li class="dropdown-item"><a href="/Frontend/Vue/" class="nav-link" aria-label="Vue"><!---->Vue<!----></a></li><li class="dropdown-item"><a href="/Frontend/MiniProgram/" class="nav-link" aria-label="MiniProgram"><!---->MiniProgram<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/Algorithm/" class="nav-link" aria-label="Algorithm"><!---->Algorithm<!----></a></div><div class="nav-item hide-in-mobile"><a href="/Linux/" class="nav-link" aria-label="Linux"><!---->Linux<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Guet"><span class="title"><!---->Guet</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/GUET/C++/" class="nav-link" aria-label="C++"><!---->C++<!----></a></li><li class="dropdown-item"><a href="/GUET/Database/" class="nav-link" aria-label="Database"><!---->Database<!----></a></li><li class="dropdown-item"><a href="/GUET/Java/" class="nav-link" aria-label="Java"><!---->Java<!----></a></li><li class="dropdown-item"><a href="/GUET/ACM%E7%AC%94%E8%AE%B0/" class="nav-link" aria-label="ACM Algorithm"><!---->ACM Algorithm<!----></a></li><li class="dropdown-item"><a href="/GUET/%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%86%E6%9E%90/" class="nav-link" aria-label="算法设计与分析"><!---->算法设计与分析<!----></a></li><li class="dropdown-item"><a href="/GUET/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" class="nav-link" aria-label="数学建模"><!---->数学建模<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/Others/" class="nav-link" aria-label="Others"><!---->Others<!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/CoderWDD" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/Android/Intermediate/" class="nav-link sidebar-link sidebar-page" aria-label="Android进阶栏目"><!---->Android进阶栏目<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/AndroidStylingSystem.html" class="nav-link sidebar-link sidebar-page" aria-label="Android styling system"><!---->Android styling system<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E7%B3%BB%E5%88%97%E4%B9%8B%E5%85%A5%E9%97%A8%E7%AE%80%E4%BB%8B.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose系列之入门简介"><!---->Compose系列之入门简介<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose编程思想"><!---->Compose编程思想<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose状态管理"><!---->Compose状态管理<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose生命周期"><!---->Compose生命周期<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%99%84%E5%B8%A6%E6%95%88%E5%BA%94.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose中的附带效应"><!---->Compose中的附带效应<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Compose中的阶段"><!---->Compose中的阶段<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#说明" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="说明"><!---->说明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#the-three-phases-of-frame" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="The three phases of frame"><!---->The three phases of frame<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#state-reads" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="State reads"><!---->State reads<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#phased-state-reads" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Phased state reads"><!---->Phased state reads<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#phase-1-composition" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Phase 1: Composition"><!---->Phase 1: Composition<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#phase-2-layout" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Phase 2: Layout"><!---->Phase 2: Layout<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#phase-3-drawing" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Phase 3: Drawing"><!---->Phase 3: Drawing<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#optimizing-state-reads" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Optimizing state reads"><!---->Optimizing state reads<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#recomposition-loop-cyclic-phase-dependency" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Recomposition loop (cyclic phase dependency)"><!---->Recomposition loop (cyclic phase dependency)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#参考资料" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="参考资料"><!---->参考资料<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E6%9E%B6%E6%9E%84%E5%88%86%E5%B1%82.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose架构分层"><!---->Compose架构分层<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E8%87%AA%E5%AE%9A%E4%B9%89View.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose自定义View"><!---->Compose自定义View<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E5%8A%A8%E7%94%BB.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose动画"><!---->Compose动画<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E6%89%8B%E5%8A%BF.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose手势"><!---->Compose手势<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84BottomNavigation%E4%BD%BF%E7%94%A8.html" class="nav-link sidebar-link sidebar-page" aria-label="Compose使用BottomNavigation"><!---->Compose使用BottomNavigation<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Compose中的阶段</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://github.com/CoderWDD" target="_blank" rel="noopener noreferrer">瓜瓜</a></span><span property="author" content="瓜瓜"></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022年6月5日</span><meta property="datePublished" content="2022-06-05T14:47:20.000Z"></span><span class="category-info" aria-label="分类🌈" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category7 clickable" role="navigation">Jetpack Compose</li><meta property="articleSection" content="Jetpack Compose"></ul></span><span aria-label="标签🏷" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag7 clickable" role="navigation">Jetpack Compose</li><li class="tag tag5 clickable" role="navigation">Android</li><li class="tag tag1 clickable" role="navigation">Kotlin</li></ul><meta property="keywords" content="Jetpack Compose,Android,Kotlin"></span><span class="words-info" aria-label="字数🔠" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 1904 字</span><meta property="wordCount" content="1904"></span><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 6 分钟</span><meta property="timeRequired" content="PT6M"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#说明" class="router-link-active router-link-exact-active toc-link level2">说明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#the-three-phases-of-frame" class="router-link-active router-link-exact-active toc-link level2">The three phases of frame</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#state-reads" class="router-link-active router-link-exact-active toc-link level2">State reads</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#phased-state-reads" class="router-link-active router-link-exact-active toc-link level2">Phased state reads</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#phase-1-composition" class="router-link-active router-link-exact-active toc-link level3">Phase 1: Composition</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#phase-2-layout" class="router-link-active router-link-exact-active toc-link level3">Phase 2: Layout</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#phase-3-drawing" class="router-link-active router-link-exact-active toc-link level3">Phase 3: Drawing</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#optimizing-state-reads" class="router-link-active router-link-exact-active toc-link level2">Optimizing state reads</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#recomposition-loop-cyclic-phase-dependency" class="router-link-active router-link-exact-active toc-link level2">Recomposition loop (cyclic phase dependency)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%98%B6%E6%AE%B5.html#参考资料" class="router-link-active router-link-exact-active toc-link level2">参考资料</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><p>Compose 会通过几个不同的“阶段”来渲染帧。如果我们观察一下 Android View 系统，就会发现它有 3 个主要阶段：测量、布局和绘制。Compose 和它非常相似，但开头多了一个叫做“组合”的重要阶段。</p><h2 id="说明" tabindex="-1"><a class="header-anchor" href="#说明" aria-hidden="true">#</a> 说明</h2><p>由于翻译很多地方存在概念难以讲明的问题，且翻译后，其实也会无形中给学习先进的Android技术造成语言壁垒，所以，在之后的文章里，如果是官网中文翻译不是很好的文章，则采用<strong>英文为主，中文解释为辅</strong>的方式进行组织编写</p><h2 id="the-three-phases-of-frame" tabindex="-1"><a class="header-anchor" href="#the-three-phases-of-frame" aria-hidden="true">#</a> The three phases of frame</h2><ul><li><p>Compose has three main phases:</p><ul><li><strong>Composition</strong>（组合）: <em>What</em> UI to show. Compose runs composable functions and creates a description of your UI.</li><li><strong>Layout</strong>（布局）: <em>Where</em> to place UI. This phase consists of two steps: measurement and placement. Layout elements measure and place themselves and any child elements in 2D coordinates, for each node in the layout tree.</li><li><strong>Drawing</strong>（绘制）: <em>How</em> it renders. UI elements draw into a Canvas, usually a device screen.</li></ul></li><li><p>下面给出几个 phases 的执行顺序图：Allowing data to flow in one direction from composition to layout to drawing to produce a frame</p><p><img src="https://raw.githubusercontent.com/CoderWDD/myImages/main/blog_images/phases-3-phases.svg" alt="phases-3-phases" loading="lazy"></p></li><li><p>Principle: <strong>Compose performs only the minimum amount of work required to update the UI.</strong></p></li></ul><h2 id="state-reads" tabindex="-1"><a class="header-anchor" href="#state-reads" aria-hidden="true">#</a> State reads</h2><p>State is commonly created using <code>mutableStateOf()</code> and then accessed through one of two ways: by directly accessing the <code>value</code> property, or alternatively by using a Kotlin property delegate. For the purposes of this guide, a &quot;state read&quot; refers to either of those equivalent access methods.</p><ul><li><p><code>mutableStateOf</code>:</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">// State read without property delegate.</span>
<span class="token keyword">val</span> paddingState<span class="token operator">:</span> MutableState<span class="token operator">&lt;</span>Dp<span class="token operator">&gt;</span> <span class="token operator">=</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token function">Text</span><span class="token punctuation">(</span>
    text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Hello&quot;</span></span><span class="token punctuation">,</span>
    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span>paddingState<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>property delegate</code>:</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">// State read with property delegate.</span>
<span class="token keyword">var</span> padding<span class="token operator">:</span> Dp <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token function">Text</span><span class="token punctuation">(</span>
    text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Hello&quot;</span></span><span class="token punctuation">,</span>
    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span>padding<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Under the hood of the <a href="https://kotlinlang.org/docs/delegated-properties.html" target="_blank" rel="noopener noreferrer">property delegate<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, &quot;getter&quot; and &quot;setter&quot; functions are used to access and update the State’s <code>value</code>. These getter and setter functions are only invoked when you reference the property as a value, and not when it is created, which is why the two ways above are equivalent.</p></li></ul><p>Notice: Each block of code that can be re-executed when a read state changes is a <em>restart scope</em>. Compose keeps track of state value changes and restart scopes in different phases.</p><h2 id="phased-state-reads" tabindex="-1"><a class="header-anchor" href="#phased-state-reads" aria-hidden="true">#</a> Phased state reads</h2><p>As mentioned above, there are three main phases in Compose, and Compose tracks what state is read within each of them. <strong>This allows Compose to notify only the specific phases that need to perform work for each affected element of your UI.</strong></p><p>下面介绍每个 phase 在 read state 时都发生了什么</p><h3 id="phase-1-composition" tabindex="-1"><a class="header-anchor" href="#phase-1-composition" aria-hidden="true">#</a> Phase 1: Composition</h3><p>State reads within a <code>@Composable</code> function or lambda block affect composition and potentially the subsequent phases. When the state value changes, the recomposer schedules reruns of all the composable functions which read that state value.</p><p>Depending on the result of composition, Compose UI runs the layout and drawing phases. It might skip these phases if the content remains the same and the size and the layout won&#39;t change.</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">var</span> padding <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token function">Text</span><span class="token punctuation">(</span>
    text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Hello&quot;</span></span><span class="token punctuation">,</span>
    <span class="token comment">// The `padding` state is read in the composition phase</span>
    <span class="token comment">// when the modifier is constructed.</span>
    <span class="token comment">// Changes in `padding` will invoke recomposition.</span>
    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span>padding<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Note:</strong> Where a state instance is created and stored has little bearing on the phases, it only matters when and where a state value is <strong>read</strong>.</p><h3 id="phase-2-layout" tabindex="-1"><a class="header-anchor" href="#phase-2-layout" aria-hidden="true">#</a> Phase 2: Layout</h3><ul><li><p>The layout phase consists of two steps: <em>measurement</em> and <em>placement</em>.</p><ul><li><strong>measurement</strong>: The measurement step runs the measure lambda passed to the <code>Layout</code> composable, the <code>MeasureScope.measure</code> method of the <code>LayoutModifier</code> interface, and so on.</li><li><strong>placement</strong>: The placement step runs the placement block of the <code>layout</code> function, the lambda block of <code>Modifier.offset { … }</code>, and so on.</li></ul></li><li><p>State reads during each of these steps affect the layout and potentially the drawing phase. When the state value changes, Compose UI schedules the layout phase. It also runs the drawing phase if size or position has changed.</p></li><li><p>To be more precise, the measurement step and the placement step have separate restart scopes, meaning that state reads in the placement step don&#39;t re-invoke the measurement step before that. However, these two steps are often intertwined, so a state read in the placement step can affect other restart scopes that belong to the measurement step.</p></li></ul><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">var</span> offsetX <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token function">Text</span><span class="token punctuation">(</span>
    text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Hello&quot;</span></span><span class="token punctuation">,</span>
    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">offset</span> <span class="token punctuation">{</span>
        <span class="token comment">// The `offsetX` state is read in the placement step</span>
        <span class="token comment">// of the layout phase when the offset is calculated.</span>
        <span class="token comment">// Changes in `offsetX` restart the layout.</span>
        <span class="token function">IntOffset</span><span class="token punctuation">(</span>offsetX<span class="token punctuation">.</span><span class="token function">roundToPx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="phase-3-drawing" tabindex="-1"><a class="header-anchor" href="#phase-3-drawing" aria-hidden="true">#</a> Phase 3: Drawing</h3><p>State reads during drawing code affect the drawing phase. Common examples include <code>Canvas()</code>, <code>Modifier.drawBehind</code>, and <code>Modifier.drawWithContent</code>. When the state value changes, Compose UI runs only the draw phase.</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">var</span> color <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Red<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token function">Canvas</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> modifier<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The `color` state is read in the drawing phase</span>
    <span class="token comment">// when the canvas is rendered.</span>
    <span class="token comment">// Changes in `color` restart the drawing.</span>
    <span class="token function">drawRect</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面给出三个阶段分别进行的操作概览图：</p><p><img src="https://raw.githubusercontent.com/CoderWDD/myImages/main/blog_images/phases-state-read-draw.svg" alt="phases-state-read-draw" loading="lazy"></p><h2 id="optimizing-state-reads" tabindex="-1"><a class="header-anchor" href="#optimizing-state-reads" aria-hidden="true">#</a> Optimizing state reads</h2><ul><li><p>引入：Let’s take a look at an example. Here we have an <code>Image()</code> which uses the offset modifier to offset its final layout position, resulting in a parallax effect as the user scrolls.</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code>Box <span class="token punctuation">{</span>
    <span class="token keyword">val</span> listState <span class="token operator">=</span> <span class="token function">rememberLazyListState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">Image</span><span class="token punctuation">(</span>
        <span class="token comment">// Non-optimal implementation!</span>
        Modifier<span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>
            <span class="token function">with</span><span class="token punctuation">(</span>LocalDensity<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// State read of firstVisibleItemScrollOffset in composition</span>
                <span class="token punctuation">(</span>listState<span class="token punctuation">.</span>firstVisibleItemScrollOffset <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    <span class="token function">LazyColumn</span><span class="token punctuation">(</span>state <span class="token operator">=</span> listState<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This code works, but results in nonoptimal performance. As written, the code reads the value of the <code>firstVisibleItemScrollOffset</code> state and passes it to the <a href="https://developer.android.com/reference/kotlin/androidx/compose/foundation/layout/package-summary#(androidx.compose.ui.Modifier).offset(androidx.compose.ui.unit.Dp,androidx.compose.ui.unit.Dp)" target="_blank" rel="noopener noreferrer"><code>Modifier.offset(offset: Dp)</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> function. As the user scrolls the <code>firstVisibleItemScrollOffset</code> value will change. As we know, Compose tracks any state reads so that it can restart (re-invoke) the reading code, which in our example is the content of the <code>Box</code>.</p><p>This is an example of state being read within the <strong>composition</strong> phase. This is not necessarily a bad thing at all, and in fact is the basis of recomposition, allowing data changes to emit new UI.</p><p>In this example though it is nonoptimal, because every scroll event will result in the entire composable content being reevaluated, and then also measured, laid out and finally drawn. We’re triggering the Compose phase on every scroll even though <strong>what</strong> we are showing hasn’t changed, only <strong>where</strong> it is shown. We can optimize our state read to only re-trigger the layout phase.</p><p>There is another version of the offset modifier available: <a href="https://developer.android.com/reference/kotlin/androidx/compose/foundation/layout/package-summary#(androidx.compose.ui.Modifier).offset(kotlin.Function1)" target="_blank" rel="noopener noreferrer"><code>Modifier.offset(offset: Density.() -&gt; IntOffset)</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>This version takes a lambda parameter, where the resulting offset is returned by the lambda block. Let’s update our code to use it:</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code>Box <span class="token punctuation">{</span>
    <span class="token keyword">val</span> listState <span class="token operator">=</span> <span class="token function">rememberLazyListState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">Image</span><span class="token punctuation">(</span>
        Modifier<span class="token punctuation">.</span><span class="token function">offset</span> <span class="token punctuation">{</span>
            <span class="token comment">// State read of firstVisibleItemScrollOffset in Layout</span>
            <span class="token function">IntOffset</span><span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> listState<span class="token punctuation">.</span>firstVisibleItemScrollOffset <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

    <span class="token function">LazyColumn</span><span class="token punctuation">(</span>state <span class="token operator">=</span> listState<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So why is this more performant? The lambda block we provide to the modifier is invoked during the <strong>layout</strong> phase (specifically, during the layout phase&#39;s placement step), meaning that our <code>firstVisibleItemScrollOffset</code> state is no longer read during composition. Because Compose tracks when state is read, this change means that if the <code>firstVisibleItemScrollOffset</code> value changes, Compose only has to restart the layout and drawing phases.（即只需要重新进行布局、绘制阶段即可，从而省略组合阶段）</p></li></ul><h2 id="recomposition-loop-cyclic-phase-dependency" tabindex="-1"><a class="header-anchor" href="#recomposition-loop-cyclic-phase-dependency" aria-hidden="true">#</a> Recomposition loop (cyclic phase dependency)</h2><ul><li><p>引入：Earlier we mentioned that the phases of Compose are always invoked in the same order, and that there is no way to go backwards while in the same frame. However, that doesn’t prohibit apps getting into composition loops across <em>different</em> frames. Consider this example:</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code>Box <span class="token punctuation">{</span>
    <span class="token keyword">var</span> imageHeightPx <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>

    <span class="token function">Image</span><span class="token punctuation">(</span>
        painter <span class="token operator">=</span> <span class="token function">painterResource</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>rectangle<span class="token punctuation">)</span><span class="token punctuation">,</span>
        contentDescription <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;I&#39;m above the text&quot;</span></span><span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> Modifier
            <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">onSizeChanged</span> <span class="token punctuation">{</span> size <span class="token operator">-&gt;</span>
                <span class="token comment">// Don&#39;t do this</span>
                imageHeightPx <span class="token operator">=</span> size<span class="token punctuation">.</span>height
            <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

    <span class="token function">Text</span><span class="token punctuation">(</span>
        text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;I&#39;m below the image&quot;</span></span><span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span>
            top <span class="token operator">=</span> <span class="token function">with</span><span class="token punctuation">(</span>LocalDensity<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span> imageHeightPx<span class="token punctuation">.</span><span class="token function">toDp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here we have (badly) implemented a vertical column, with the image at the top, and then the text below it. We’re using <code>Modifier.onSizeChanged()</code> to know the resolved size of the image, and then using <code>Modifier.padding()</code> on the text to shift it down. The unnatural conversion from <code>Px</code> back to <code>Dp</code> already indicates that the code has some issue.</p><p>The issue with this example is that we don’t arrive at the &quot;final&quot; layout within a single frame. The code relies on multiple frames happening, which performs unnecessary work, and results in UI jumping around on screen for the user.</p><p>Let’s step through each frame to see what is happening:</p><p>At the composition phase of the first frame, <code>imageHeightPx</code> has a value of 0, and the text is provided with <code>Modifier.padding(top = 0)</code>. Then, the layout phase follows, and the callback for the <code>onSizeChanged</code> modifier is called. This is when the <code>imageHeightPx</code> is updated to the actual height of the image. Compose schedules recomposition for the next frame. At the drawing phase, the text is rendered with the padding of 0 since the value change is not reflected yet.</p><p>Compose then starts the second frame scheduled by the value change of <code>imageHeightPx</code>. The state is read in the Box content block, and it is invoked in the composition phase. This time, the text is provided with a padding matching the image height. At the layout phase, the code does set the value of <code>imageHeightPx</code> again, but no recomposition is scheduled since the value remains the same.</p><p>In the end, we get the desired padding on the text, but it is nonoptimal to spend an extra frame to pass the padding value back to a different phase and will result in producing a frame with overlapping content.</p><p><img src="https://raw.githubusercontent.com/CoderWDD/myImages/main/blog_images/phases-recomp-loop.svg" alt="phases-recomp-loop" loading="lazy"></p></li><li><p>This example may seem contrived, but be careful of this general pattern:</p><ul><li><p><code>Modifier.onSizeChanged()</code>, <code>onGloballyPositioned()</code>, or some other layout operations</p></li><li><p>Update some state</p></li><li><p>Use that state as input to a layout modifier (<code>padding()</code>,<code>height()</code>, or similar)</p></li><li><p>Potentially repeat</p></li></ul></li><li><p>Principle: The general principle here is to have a single source of truth for multiple UI elements that should be measured and placed with regards to one another. Using a proper layout primitive or creating a custom layout means that the minimal shared parent serves as the source of truth that can coordinate the relation between multiple elements.</p></li></ul><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料" aria-hidden="true">#</a> 参考资料</h2><ul><li>绝大多数来自<a href="https://developer.android.com/jetpack/compose/phases" target="_blank" rel="noopener noreferrer">官方文档 - 英文原版<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><!--]--></div><!----><footer class="page-meta"><!----><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/6/5 15:01:26</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: CoderWdd@gmail.com">CoderWdd</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/Android/Intermediate/Compose%E4%B8%AD%E7%9A%84%E9%99%84%E5%B8%A6%E6%95%88%E5%BA%94.html" class="nav-link prev" aria-label="Compose中的附带效应"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->Compose中的附带效应</div></a><a href="/Android/Intermediate/Compose%E6%9E%B6%E6%9E%84%E5%88%86%E5%B1%82.html" class="nav-link next" aria-label="Compose架构分层"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">Compose架构分层<!----></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">瓜娃子日寄</div><!----></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.776ac834.js" defer></script>
  </body>
</html>
