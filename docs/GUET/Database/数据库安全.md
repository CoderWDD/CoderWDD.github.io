---
category:
  - Database
index : 3
title : 第三章：数据库安全性
---
# 数据库安全性

## 数据库安全的基本机制

- 身份认证
- 存取访问控制
- 视图
- 审计
- 密码存储

---

### 身份认证

- 是系统提供的最外层安全保护措施，通过一定的方式让用户标识自己的名字或身份
- 用户标识 + 口令

---

### 访问控制

- 指定义用户权限，并将用户权限登记到数据字典中
- 权限检查

---

### 存取访问控制

#### 自主存取控制

- 采用权限授予机制，让用户对不同的数据库对象具有不同的存取权限。即事先定义好用户可以在哪些数据库对象上进行哪些类型的操作

- 用户权限组成：

  - 数据对象
  - 操作类型

- 操作关键字：`GRANT`、`REVOKE`

- 授权语句：

  语义：将对指定操作对象的指定操作权限授予指定的用户。 

  ```sql
  GRANT <权限>  [,<权限>]... 
  [ON <对象类型>  <对象名> ]
  TO <用户> [,<用户>] ...
  [WITH GRANT OPTION];
  eg：把对表SC的INSERT权限授予U5用户，并允许他再将此权限授予其他用户
  GRANT INSERT 
  ON TABLE SC 
  TO U5
  WITH GRANT OPTION
  ```

  注：`WITH GRANT OPTION`，授权选项，指用户可以把当前接收的操作权限`再授予`其他用户，即让用户具有**传播**权限的能力。

- 收回权限语句：

  ```sql
  REVOKE <权限> [,<权限>]... 
  [ON <对象类型> <对象名>]
  FROM <用户> [,<用户>]... 
  [CASCADE];
  eg: 把用户U5对SC表的INSERT权限收回
  REVOKE INSERT 
  ON TABLE SC 
  FROM U5 CASCADE ;
  ```

  注：`CASCADE`表示级联收回，与授权时候的`WITH GRANT OPTION`相对应

#### 多途径权限的收回

- 由于用户可以从多个途径继承同一个操作权限，这使得当需要禁止该用户具有该操作权限时，也必须从多个途径进行取消。这是一个繁琐的过程。
- DENY：拒绝权限

```sql
DENY SELECT, INSERT, UPDATE, DELETE
ON Student
TO zhang
```

#### 强制存取控制

- 主体：系统中的活动实体，DBMS所管理的实际用户或代表用户的各进程。
- 客体：系统中的被动实体，是受主体操纵的数据库对象，例如存储文件、基本表、索引、视图等。

- 敏感度标记
  - 绝密（Top Secret）/ 机密（Secret）/ 可信（Confidential）/ 公开（Public）
  - 主体的敏感度标记称为许可证级别（Clearance Level）
  - 客体的敏感度标记称为密级（Classification Level）

- 控制规则：
  - 仅当主体的许可证级别**大于或等于**客体的密级时，该主体**才能读**取相应的客体；
  - 仅当主体的许可证级别**等于**客体的密级时，该主体**才能写**相应的客体

---

### 视图

- 视图限定了用户查看数据的视角，对无权进行（指定）数据存取的用户实行数据隐藏，对数据提供一定程度的安全保护 。

- 实例：

  - 建立计算机系学生的视图，把对该视图的SELECT权限授于王平，把该视图上的所有操作权限授于张明。

  - Step1：

    ```sql
    CREATE VIEW CS_Student
    AS 
       SELECT  *
       FROM   Student
       WHERE  Sdept='CS'
    ```

  - Step2：

    ```sql
    GRANT  SELECT
    ON  CS_Student  
    TO 王平
    ```

  - Step3：

    ```sql
    GRANT ALL PRIVILIGES
    ON  CS_Student  
    TO  张明
    ```

---

### 审计

#### 什么是审计

- 审计日志（Audit Log）：记录用户对数据库的所有操作记录；
- DBA可以利用审计日志，找出非法存取数据的人、时间和内容；
- 符合C2及以上安全级别的DBMS必须具备审计功能。

#### 审计类型

- 用户级审计
  - 针对自己创建的数据库表或视图进行审计 
  - 记录所有用户对这些表或视图的一切成功和不成功的访问要求以及各种类型的SQL操作 
- 系统级审计 
  - DBA设置
  - 监测成功或失败的登录要求 
  - 监测GRANT和REVOKE操作以及其它数据库级权限下的操作
- 关键字：`AUDIT`、`NOAUDIT`

- 实例：

  - 对修改SC表结构或修改SC表数据的操作进行审计

    ```sql
    AUDIT ALTER，UPDATE  
    ON  SC
    ```

  - 取消对SC表的一切审计

    ```sql
    NOAUDIT  ALTER，UPDATE  
    ON  SC
    ```

---

### 加密

- 数据加密的作用：防止数据库中数据在存储和传输中失密的有效手段

- 加密的基本思想：

  - 对称密钥加密

  - 非对称密钥加密

  - 基于散列方法的加密

